console.log("Feimao Extension Background Service Worker Loaded");chrome.runtime.onInstalled.addListener(()=>{console.log("Feimao Extension installed")});chrome.runtime.onMessage.addListener((o,l,a)=>{if(o.action==="API_REQUEST"){const{method:s,url:i,data:c,headers:d}=o.payload,r={method:s||"GET",headers:{"Content-Type":"application/json",...d||{}},body:s==="POST"||s==="PUT"?JSON.stringify(c):void 0};return fetch(i,r).then(async e=>{let t;const n=e.headers.get("content-type");n&&n.includes("application/json")?t=await e.json():t=await e.text(),e.ok?a({success:!0,data:t}):a({success:!1,error:t.message||e.statusText||"Request failed",status:e.status})}).catch(e=>{a({success:!1,error:e.message})}),!0}});
